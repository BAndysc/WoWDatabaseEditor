<UserControl x:Class="WDE.Solutions.Explorer.Views.SolutionExplorerView"
             
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:views="clr-namespace:WDE.Solutions.Explorer.Views"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             xmlns="https://github.com/avaloniaui"
             prism:ViewModelLocator.AutoWireViewModel="False" x:Name="UC">
    
    <UserControl.Resources>
        <DrawingImage x:Key="Folder">
            <DrawingImage.Drawing>
                <DrawingGroup>
                    <GeometryDrawing Brush="#4FCAE6"
                                     Geometry="F1 M20,20z M0,0z M8,2L2,2C0.9,2,0,2.9,0,4L0,16C0,17.1,0.9,18,2,18L18,18C19.1,18,20,17.1,20,16L20,6C20,4.9,19.1,4,18,4L10,4 8,2z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="File">
            <DrawingImage.Drawing>
                <DrawingGroup >
                    <GeometryDrawing Brush="#FF575757"
                                     Geometry="F0 M16,16z M0,0z M14,4L14,13.913 13,15 3,15 2,14 2,2 3,1 12,1 14,4z M3.394,1.95L2.95,2.394 2.95,13.606 3.394,14.05 12.583,14.05 13.05,13.542 13.05,4.288 11.492,1.95 3.394,1.95z" />
                    <GeometryDrawing Brush="#FF575757" Geometry="F0 M16,16z M0,0z M11,1L11,4 14,4 11,1z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
    </UserControl.Resources>
    
    <TreeView x:Name="tv" Margin="0" Items="{Binding Root}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" DoubleTapped="Tv_OnDoubleTapped">
            <TreeView.Styles>
                <Style Selector="ItemsPresenter">
                    <Setter Property="Margin" Value="0"></Setter>
                </Style>
                <Style Selector="TreeViewItem">
                    <Setter Property="Padding" Value="8"></Setter>
                    <Setter Property="ContextMenu">
                        <Setter.Value>
                            <ContextMenu>
                                <MenuItem Header="Add"
                                          Command="{Binding #tv.DataContext.AddItem}"
                                          IsEnabled="{Binding IsContainer}" />
                                <MenuItem Header="Remove"
                                          Command="{Binding #tv.DataContext.RemoveItem}" />
                                <Separator />
                                <MenuItem Header="Generate SQL"
                                          Command="{Binding #tv.DataContext.GenerateSQL}"
                                          IsEnabled="{Binding IsExportable}" />
                            </ContextMenu>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TreeView.Styles>
            <TreeView.DataTemplates>
                <TreeDataTemplate ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal">
                        <Image Width="14" Height="14" Stretch="Fill" Margin="0,0,6,0" Source="{StaticResource File}">
                            <Interaction.Behaviors>
                                <DataTriggerBehavior Binding="{Binding IsContainer}" ComparisonCondition="Equal" Value="True">
                                    <ChangePropertyAction TargetObject="{Binding #Image}" PropertyName="Source" Value="{StaticResource Folder}"/>
                                </DataTriggerBehavior>
                            </Interaction.Behaviors>
                        </Image>
                        <TextBlock Padding="2" VerticalAlignment="Center" Text="{Binding ExtraId}"
                                   FontFamily="Consolas" Background="{DynamicResource ContentSpecialBackground}"
                                   Foreground="{DynamicResource ContentSpecialForeground}" Margin="0,0,7,0">
                            <Interaction.Behaviors>
                                <DataTriggerBehavior Binding="{Binding ExtraId}" ComparisonCondition="Equal" Value="{x:Null}">
                                    <ChangePropertyAction TargetObject="TextBlock" PropertyName="IsVisible" Value="False"/>
                                </DataTriggerBehavior>
                            </Interaction.Behaviors>
                        </TextBlock>
                        <TextBlock Margin="0,0,0,0" Padding="0,0,0,0" VerticalAlignment="Center"
                                   Text="{Binding Name}" />
                    </StackPanel>
                </TreeDataTemplate>
            </TreeView.DataTemplates>
        </TreeView>
</UserControl>